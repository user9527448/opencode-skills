# Safe Refactoring

> 面向 AI 编码代理人的全面重构协议。

## 概述

Safe Refactoring 提供了一种系统化的代码重构方法，通过小步骤、持续验证和行为保留来优先考虑安全性。

## 功能特性

- **5 阶段工作流**：评估 → 准备 → 计划 → 执行 → 验证
- **代码异味指南**：14 种常见异味及修复方法
- **重构目录**：15 种重构技术
- **真实场景**：逐步示例
- **模板**：重构前检查清单、执行计划

## 目录结构

```
safe-refactoring/
├── SKILL.md                      # 主技能 (274 行)
├── references/
│   ├── catalog/
│   │   └── refactoring-types.md   # 15 种重构类型
│   └── smells/
│       └── code-smells.md           # 14 种代码异味
├── examples/
│   └── scenarios/
│       └── refactoring-scenarios.md # 真实案例
└── templates/
    ├── pre-refactor-checklist.md
    └── execution-plan.md
```

## 快速开始

### 加载技能

```javascript
skill({ name: "safe-refactoring" })
```

### 基本工作流

```
1. 评估    → 理解代码，测量指标
2. 准备   → 使用检查清单模板
3. 计划      → 选择重构类型
4. 执行   → 循环：更改 → 测试 → 提交
5. 验证    → 完整测试套件，推送
```

## 关键原则

| 原则 | 描述 |
|-----------|-------------|
| 🟢 绿色 | 测试必须在开始前通过 |
| 📏 小 | 每次做一个小改动 |
| ✅ 验证 | 每次更改后运行测试 |
| 💾 提交 | 频繁创建检查点 |

## 重构类型

| 类型 | 使用时机 |
|------|-------------|
| 提取方法 | 具有明确目的的长方法 |
| 重命名 | 名称不能表达意图 |
| 移动方法 | 特性 envy - 更多使用其他类 |
| 提取类 | 多种职责 |
| 替换条件 | 复杂的 if-else 链 |

## 代码异味

| 异味 | 修复 |
|--------|-----|
| 长方法 | 提取方法 |
| 大类 | 提取类 |
| 重复代码 | 提取函数 |
| 特性 envy | 移动方法 |
| 数据泥团 | 参数对象 |

## 集成

- 与 `test-driven-debugging` 配合添加测试
- 与 `code-review-guardian` 配合在重构后审查
- 使用 `code-complexity-optimizer` 进行算法改进

## 许可证

MIT
